# Java内存管理
* Author：CrazyWah
* Date：2018.04.15
* Copyright：crazywah.com


## 1、JVM的内存划分

![](picture/JVM_memory_structure_Colo_ver.png)

### 1.1、Java的内存分为线程共享区与线程隔离区

**线程共享区中有：** 方法区、堆

**线程隔离区中有：** 虚拟机栈、本地方法区、程序计数器

### 1.2、程序计数器（Program Counter Register）

**程序计数器** 是一块较小的内存空间，可以当作当前线程执行的 **字节码的行号指示器**

**字节码解释器** 就是通过改变 **程序计数器的值** 来选取 **下一条需要执行的字节码指令**

**Java虚拟机** 的 **多线程** 是通过 **线程轮流切换** 并 **分配处理器执行时间** 的方式来实现的，在任意一个确定的时刻，一个处理器都只会执行一个线程的一条指令，所以 **程序计数器相应的就应该是一个线程拥有一个（安排在线程隔离区）**

***PS：此区域没有OOM问题***

### 1.3、Java虚拟机栈（Java Virtual Machine Stack）

Java中每个方法执行时都会创建一个栈帧，用于存放局部变量表、操作数栈、动态链接、方法出口等数据

虚拟机栈就是常说的“Java的堆和栈”的“栈”了

**局部变量表：**
  * 编译期可知的各种基本数据类型
  * 对象引用类型（非对象本身，而是指向对象起始地址的指针）
  * long & double 这两个64位数据占两个局部变量空间（Slot），其他类型数据占一个。

**异常：**
  * StackOverflowError：线程申请的的栈深度超出虚拟机所允许的深度
  * OutOfMemoryError：无法申请足够内存扩展空间时

## 对象的创建过程
1. 检查
